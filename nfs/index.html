<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nafsgen.v1</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'primary-purple': '#5C0099',
                        'dark-purple': '#2E004D',
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        .aspect-9-16 {
            aspect-ratio: 9 / 16;
        }
        .download-overlay {
            background-color: rgba(0, 0, 0, 0.6);
            transition: opacity 0.3s ease;
            cursor: pointer;
        }
        .file-upload-box {
            border: 2px dashed #6b7280;
            transition: border-color 0.2s ease;
        }
        .file-upload-box:hover {
            border-color: #a78bfa; /* purple-400 */
        }
        .active-button {
            background-color: #a78bfa; /* purple-400 */
            color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="bg-dark-purple text-gray-100 font-sans p-4 min-h-screen flex items-center justify-center">

    <div class="container mx-auto p-6 bg-primary-purple rounded-xl shadow-lg w-full max-w-7xl">
        <h1 class="text-3xl sm:text-4xl font-bold text-center mb-6">nafsgen.v1</h1>
        <div class="flex flex-col lg:flex-row gap-8">

            <!-- Kolom Kiri: Input -->
            <div class="flex-1 space-y-6">
                <h2 class="text-2xl font-semibold mb-4">Pengaturan</h2>
                
                <!-- Input Upload Gambar (2 Kolom) -->
                <div>
                    <p class="text-sm font-medium mb-2">Unggah Foto Produk</p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <label for="image-upload-1" class="relative block w-full aspect-video rounded-lg file-upload-box text-center p-4 cursor-pointer">
                            <input type="file" id="image-upload-1" accept="image/*" class="absolute inset-0 opacity-0 cursor-pointer">
                            <span class="block text-xl font-bold mb-2">Unggah Gambar 1</span>
                            <span class="block text-sm">klik atau seret & jatuhkan di sini</span>
                        </label>
                        <label for="image-upload-2" class="relative block w-full aspect-video rounded-lg file-upload-box text-center p-4 cursor-pointer">
                            <input type="file" id="image-upload-2" accept="image/*" class="absolute inset-0 opacity-0 cursor-pointer">
                            <span class="block text-xl font-bold mb-2">Unggah Gambar 2</span>
                            <span class="block text-sm">klik atau seret & jatuhkan di sini</span>
                        </label>
                    </div>
                </div>

                <!-- Tombol Pilihan Gender -->
                <div>
                    <p class="text-sm font-medium mb-2">Pilih Model</p>
                    <div class="flex space-x-4">
                        <button class="flex-1 py-3 px-6 rounded-lg font-semibold bg-gray-700 hover:bg-purple-400 transition-colors" data-gender="pria">Pria</button>
                        <button class="flex-1 py-3 px-6 rounded-lg font-semibold bg-gray-700 hover:bg-purple-400 transition-colors" data-gender="wanita">Wanita</button>
                    </div>
                </div>

                <!-- Tombol Pilihan Gaya -->
                <div>
                    <p class="text-sm font-medium mb-2">Pilih Gaya Video</p>
                    <div class="grid grid-cols-2 gap-4">
                        <button class="py-3 px-6 rounded-lg font-semibold bg-gray-700 hover:bg-purple-400 transition-colors" data-style="iklan-pakaian">Iklan Pakaian</button>
                        <button class="py-3 px-6 rounded-lg font-semibold bg-gray-700 hover:bg-purple-400 transition-colors" data-style="iklan-makanan-ringan">Iklan Makanan Ringan</button>
                        <button class="py-3 px-6 rounded-lg font-semibold bg-gray-700 hover:bg-purple-400 transition-colors" data-style="iklan-makeup">Iklan Makeup</button>
                        <button class="py-3 px-6 rounded-lg font-semibold bg-gray-700 hover:bg-purple-400 transition-colors" data-style="natural">Natural</button>
                        <button class="py-3 px-6 rounded-lg font-semibold bg-gray-700 hover:bg-purple-400 transition-colors" data-style="story">Story</button>
                        <button class="py-3 px-6 rounded-lg font-semibold bg-gray-700 hover:bg-purple-400 transition-colors" data-style="sci-fi">Sci-fi</button>
                        <button class="py-3 px-6 rounded-lg font-semibold bg-gray-700 hover:bg-purple-400 transition-colors" data-style="sinematic">Sinematik</button>
                        <button class="py-3 px-6 rounded-lg font-semibold bg-gray-700 hover:bg-purple-400 transition-colors" data-style="cyberpunk">Cyberpunk</button>
                    </div>
                </div>

                <!-- Tombol Generate dan Clear -->
                <div class="flex space-x-4">
                    <button id="generate-image-button" class="flex-1 py-4 px-6 bg-purple-600 text-white font-bold rounded-lg hover:bg-purple-700 transition-colors shadow-md">
                        Generate Image
                    </button>
                    <button id="clear-button" class="py-4 px-6 bg-gray-500 text-white font-bold rounded-lg hover:bg-gray-600 transition-colors">
                        Clear
                    </button>
                </div>
            </div>

            <!-- Kolom Kanan: Output -->
            <div class="flex-1">
                <h2 class="text-2xl font-semibold mb-4">Hasil Generasi</h2>
                <div id="output-container" class="grid grid-cols-2 md:grid-cols-3 gap-4">
                    <!-- Placeholder untuk hasil gambar -->
                    <div class="rounded-xl overflow-hidden shadow-md bg-gray-800 flex flex-col items-center">
                        <div class="relative w-full aspect-9-16 group">
                            <div class="w-full h-full bg-gray-600 flex items-center justify-center text-gray-400">
                                <span class="text-center p-4">Gambar 1<br>(Rasio 9:16)</span>
                            </div>
                            <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 download-overlay transition-opacity">
                                <a href="#" download="nafsgen_result_1.png" class="text-white text-lg font-bold">Unduh</a>
                            </div>
                        </div>
                        <button class="w-full py-2 px-4 mt-2 mb-2 text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors generate-video-button">Generate Video</button>
                    </div>
                    <!-- Ulangi div ini 5 kali untuk 6 gambar total -->
                    <div class="rounded-xl overflow-hidden shadow-md bg-gray-800 flex flex-col items-center">
                        <div class="relative w-full aspect-9-16 group">
                            <div class="w-full h-full bg-gray-600 flex items-center justify-center text-gray-400">
                                <span class="text-center p-4">Gambar 2<br>(Rasio 9:16)</span>
                            </div>
                            <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 download-overlay transition-opacity">
                                <a href="#" download="nafsgen_result_2.png" class="text-white text-lg font-bold">Unduh</a>
                            </div>
                        </div>
                        <button class="w-full py-2 px-4 mt-2 mb-2 text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors generate-video-button">Generate Video</button>
                    </div>
                    <div class="rounded-xl overflow-hidden shadow-md bg-gray-800 flex flex-col items-center">
                        <div class="relative w-full aspect-9-16 group">
                            <div class="w-full h-full bg-gray-600 flex items-center justify-center text-gray-400">
                                <span class="text-center p-4">Gambar 3<br>(Rasio 9:16)</span>
                            </div>
                            <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 download-overlay transition-opacity">
                                <a href="#" download="nafsgen_result_3.png" class="text-white text-lg font-bold">Unduh</a>
                            </div>
                        </div>
                        <button class="w-full py-2 px-4 mt-2 mb-2 text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors generate-video-button">Generate Video</button>
                    </div>
                    <div class="rounded-xl overflow-hidden shadow-md bg-gray-800 flex flex-col items-center">
                        <div class="relative w-full aspect-9-16 group">
                            <div class="w-full h-full bg-gray-600 flex items-center justify-center text-gray-400">
                                <span class="text-center p-4">Gambar 4<br>(Rasio 9:16)</span>
                            </div>
                            <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 download-overlay transition-opacity">
                                <a href="#" download="nafsgen_result_4.png" class="text-white text-lg font-bold">Unduh</a>
                            </div>
                        </div>
                        <button class="w-full py-2 px-4 mt-2 mb-2 text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors generate-video-button">Generate Video</button>
                    </div>
                    <div class="rounded-xl overflow-hidden shadow-md bg-gray-800 flex flex-col items-center">
                        <div class="relative w-full aspect-9-16 group">
                            <div class="w-full h-full bg-gray-600 flex items-center justify-center text-gray-400">
                                <span class="text-center p-4">Gambar 5<br>(Rasio 9:16)</span>
                            </div>
                            <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 download-overlay transition-opacity">
                                <a href="#" download="nafsgen_result_5.png" class="text-white text-lg font-bold">Unduh</a>
                            </div>
                        </div>
                        <button class="w-full py-2 px-4 mt-2 mb-2 text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors generate-video-button">Generate Video</button>
                    </div>
                    <div class="rounded-xl overflow-hidden shadow-md bg-gray-800 flex flex-col items-center">
                        <div class="relative w-full aspect-9-16 group">
                            <div class="w-full h-full bg-gray-600 flex items-center justify-center text-gray-400">
                                <span class="text-center p-4">Gambar 6<br>(Rasio 9:16)</span>
                            </div>
                            <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 download-overlay transition-opacity">
                                <a href="#" download="nafsgen_result_6.png" class="text-white text-lg font-bold">Unduh</a>
                            </div>
                        </div>
                        <button class="w-full py-2 px-4 mt-2 mb-2 text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors generate-video-button">Generate Video</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Script JavaScript untuk logika -->
    <script type="module">
       import { auth, db } from "/firebase.js";
       import { getAuth, getIdToken, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
       import { getFirestore } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
        
        // Variabel global untuk Firebase
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        let db, auth, userId;
        let selectedGender = null;
        let selectedStyle = null;
        let uploadedImages = { 'image-1': null, 'image-2': null };

        // Inisialisasi Firebase dan autentikasi
        async function initFirebase() {
            try {
                if (Object.keys(firebaseConfig).length > 0) {
                    const app = initializeApp(firebaseConfig);
                    db = getFirestore(app);
                    auth = getAuth(app);
                    if (initialAuthToken) {
                        await signInWithCustomToken(auth, initialAuthToken);
                    } else {
                        await signInAnonymously(auth);
                    }
                    userId = auth.currentUser.uid;
                    console.log("Firebase initialized and authenticated successfully.");
                } else {
                    console.warn("Firebase configuration not found. Firestore features will be disabled.");
                }
            } catch (error) {
                console.error("Firebase authentication failed:", error);
            }
        }
        
        initFirebase();

        // Elemen UI
        const generateImageButton = document.getElementById('generate-image-button');
        const clearButton = document.getElementById('clear-button');
        const outputContainer = document.getElementById('output-container');
        const genderButtons = document.querySelectorAll('[data-gender]');
        const styleButtons = document.querySelectorAll('[data-style]');
        const imageUpload1 = document.getElementById('image-upload-1');
        const imageUpload2 = document.getElementById('image-upload-2');
        const fileUploadBox1 = imageUpload1.closest('label');
        const fileUploadBox2 = imageUpload2.closest('label');

        // Event listener untuk tombol gender
        genderButtons.forEach(button => {
            button.addEventListener('click', () => {
                genderButtons.forEach(btn => btn.classList.remove('active-button'));
                button.classList.add('active-button');
                selectedGender = button.dataset.gender;
                console.log('Selected Model:', selectedGender);
            });
        });

        // Event listener untuk tombol gaya
        styleButtons.forEach(button => {
            button.addEventListener('click', () => {
                styleButtons.forEach(btn => btn.classList.remove('active-button'));
                button.classList.add('active-button');
                selectedStyle = button.dataset.style;
                console.log('Selected Style:', selectedStyle);
            });
        });

        // Event listener untuk upload gambar
        imageUpload1.addEventListener('change', (event) => handleImageUpload(event, 'image-1', fileUploadBox1));
        imageUpload2.addEventListener('change', (event) => handleImageUpload(event, 'image-2', fileUploadBox2));
        
        function handleImageUpload(event, key, box) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    uploadedImages[key] = e.target.result;
                    const img = new Image();
                    img.src = e.target.result;
                    img.onload = () => {
                        box.innerHTML = `<img src="${e.target.result}" class="w-full h-full object-cover rounded-lg">`;
                    };
                    console.log(`Image ${key} uploaded:`, file.name);
                };
                reader.readAsDataURL(file);
            }
        }

        // Event listener untuk tombol 'Generate Image'
        generateImageButton.addEventListener('click', () => {
            if ((!uploadedImages['image-1'] && !uploadedImages['image-2']) || !selectedGender || !selectedStyle) {
                alert('Silakan unggah setidaknya satu gambar dan pilih model serta gaya.');
                return;
            }

            // Simulasi proses generate
            outputContainer.innerHTML = '';
            for (let i = 0; i < 6; i++) {
                const imageUrl = `https://placehold.co/900x1600/312e81/ffffff?text=Image+${i+1}`;
                const imageFrame = document.createElement('div');
                imageFrame.className = 'rounded-xl overflow-hidden shadow-md bg-gray-800 flex flex-col';
                imageFrame.innerHTML = `
                    <div class="relative w-full aspect-9-16 group">
                        <img src="${imageUrl}" class="w-full h-full object-cover">
                        <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 download-overlay transition-opacity">
                            <a href="${imageUrl}" download="nafsgen_result_${i+1}.png" class="text-white text-lg font-bold">Unduh</a>
                        </div>
                    </div>
                    <button class="w-full py-2 px-4 mt-2 mb-2 text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors generate-video-button">Generate Video</button>
                `;
                outputContainer.appendChild(imageFrame);
            }
            
            // Atur event listener untuk tombol generate video
            document.querySelectorAll('.generate-video-button').forEach(button => {
                button.addEventListener('click', (event) => {
                    alert('Simulasi: Video Veo 2.0 berhasil dibuat. Mohon tunggu proses unduhan.');
                    const tempVideoUrl = 'https://www.w3schools.com/html/mov_bbb.mp4';
                    const link = document.createElement('a');
                    link.href = tempVideoUrl;
                    link.download = `nafsgen_video.mp4`;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                });
            });
        });

        // Event listener untuk tombol 'Clear'
        clearButton.addEventListener('click', () => {
            // Reset semua input dan output
            selectedGender = null;
            selectedStyle = null;
            uploadedImages = { 'image-1': null, 'image-2': null };
            document.getElementById('image-upload-1').value = '';
            document.getElementById('image-upload-2').value = '';

            const placeholderText1 = `<span class="block text-xl font-bold mb-2">Unggah Gambar 1</span><span class="block text-sm">klik atau seret & jatuhkan di sini</span>`;
            const placeholderText2 = `<span class="block text-xl font-bold mb-2">Unggah Gambar 2</span><span class="block text-sm">klik atau seret & jatuhkan di sini</span>`;
            fileUploadBox1.innerHTML = placeholderText1;
            fileUploadBox2.innerHTML = placeholderText2;

            genderButtons.forEach(btn => btn.classList.remove('active-button'));
            styleButtons.forEach(btn => btn.classList.remove('active-button'));
            
            outputContainer.innerHTML = ''; // Hapus semua gambar hasil
            const placeholderFrames = `
                <div class="rounded-xl overflow-hidden shadow-md bg-gray-800 flex flex-col items-center">
                    <div class="relative w-full aspect-9-16 group">
                        <div class="w-full h-full bg-gray-600 flex items-center justify-center text-gray-400">
                            <span class="text-center p-4">Gambar 1<br>(Rasio 9:16)</span>
                        </div>
                        <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 download-overlay transition-opacity">
                            <a href="#" download="nafsgen_result_1.png" class="text-white text-lg font-bold">Unduh</a>
                        </div>
                    </div>
                    <button class="w-full py-2 px-4 mt-2 mb-2 text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors generate-video-button">Generate Video</button>
                </div>
                <div class="rounded-xl overflow-hidden shadow-md bg-gray-800 flex flex-col items-center">
                    <div class="relative w-full aspect-9-16 group">
                        <div class="w-full h-full bg-gray-600 flex items-center justify-center text-gray-400">
                            <span class="text-center p-4">Gambar 2<br>(Rasio 9:16)</span>
                        </div>
                        <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 download-overlay transition-opacity">
                            <a href="#" download="nafsgen_result_2.png" class="text-white text-lg font-bold">Unduh</a>
                        </div>
                    </div>
                    <button class="w-full py-2 px-4 mt-2 mb-2 text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors generate-video-button">Generate Video</button>
                </div>
                <div class="rounded-xl overflow-hidden shadow-md bg-gray-800 flex flex-col items-center">
                    <div class="relative w-full aspect-9-16 group">
                        <div class="w-full h-full bg-gray-600 flex items-center justify-center text-gray-400">
                            <span class="text-center p-4">Gambar 3<br>(Rasio 9:16)</span>
                        </div>
                        <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 download-overlay transition-opacity">
                            <a href="#" download="nafsgen_result_3.png" class="text-white text-lg font-bold">Unduh</a>
                        </div>
                    </div>
                    <button class="w-full py-2 px-4 mt-2 mb-2 text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors generate-video-button">Generate Video</button>
                </div>
                <div class="rounded-xl overflow-hidden shadow-md bg-gray-800 flex flex-col items-center">
                    <div class="relative w-full aspect-9-16 group">
                        <div class="w-full h-full bg-gray-600 flex items-center justify-center text-gray-400">
                            <span class="text-center p-4">Gambar 4<br>(Rasio 9:16)</span>
                        </div>
                        <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 download-overlay transition-opacity">
                            <a href="#" download="nafsgen_result_4.png" class="text-white text-lg font-bold">Unduh</a>
                        </div>
                    </div>
                    <button class="w-full py-2 px-4 mt-2 mb-2 text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors generate-video-button">Generate Video</button>
                </div>
                <div class="rounded-xl overflow-hidden shadow-md bg-gray-800 flex flex-col items-center">
                    <div class="relative w-full aspect-9-16 group">
                        <div class="w-full h-full bg-gray-600 flex items-center justify-center text-gray-400">
                            <span class="text-center p-4">Gambar 5<br>(Rasio 9:16)</span>
                        </div>
                        <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 download-overlay transition-opacity">
                            <a href="#" download="nafsgen_result_5.png" class="text-white text-lg font-bold">Unduh</a>
                        </div>
                    </div>
                    <button class="w-full py-2 px-4 mt-2 mb-2 text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors generate-video-button">Generate Video</button>
                </div>
                <div class="rounded-xl overflow-hidden shadow-md bg-gray-800 flex flex-col items-center">
                    <div class="relative w-full aspect-9-16 group">
                        <div class="w-full h-full bg-gray-600 flex items-center justify-center text-gray-400">
                            <span class="text-center p-4">Gambar 6<br>(Rasio 9:16)</span>
                        </div>
                        <div class="absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 group-focus-within:opacity-100 download-overlay transition-opacity">
                            <a href="#" download="nafsgen_result_6.png" class="text-white text-lg font-bold">Unduh</a>
                        </div>
                    </div>
                    <button class="w-full py-2 px-4 mt-2 mb-2 text-sm bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors generate-video-button">Generate Video</button>
                </div>
            `;
            outputContainer.innerHTML = placeholderFrames;
        });
    </script>
</body>
</html>
