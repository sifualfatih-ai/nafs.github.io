<!doctype html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <title>Nafs Premium – Studio</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="/nfsweb.ico" />

    <!-- Tailwind -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React + ReactDOM + Babel (JSX runtime di browser) -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
      html,body{background:linear-gradient(135deg,#2a0f4a,#1a0b2e 45%,#0c0516)}
      #app.nfs-frozen { filter: grayscale(.85); opacity:.55; pointer-events:none; }
      #freeze-overlay { position:fixed; inset:0; display:none; place-items:center;
        background:rgba(10,8,18,.55); backdrop-filter:blur(2px); z-index:50; color:#fff; }
      #freeze-overlay .card { background:#1b1530; border:1px solid rgba(255,255,255,.08);
        border-radius:14px; padding:18px 20px; width:min(420px,92%); text-align:center;
        box-shadow:0 10px 28px rgba(0,0,0,.35) }
    </style>
  </head>

  <body class="text-white">
    <div id="app">
      <!-- HEADER -->
      <header class="max-w-6xl mx-auto p-4">
        <div class="flex items-center justify-between gap-3">
          <div class="flex items-center gap-3">
            <div class="h-10 w-10 rounded-xl bg-gradient-to-br from-purple-400 to-fuchsia-600 grid place-items-center shadow-lg">👑</div>
            <div>
              <div class="text-xl font-semibold tracking-wide">Nafs Premium</div>
              <div class="text-xs text-white/70">Tools App All in One Serbaguna</div>
            </div>
          </div>
          <div class="flex items-center gap-2">
            <a id="homeBtn"   class="rounded-lg px-3 py-2 bg-white/10 hover:bg-white/20 text-sm" href="#">🏠 Halaman Utama</a>
            <a id="loginBtn"  class="rounded-lg px-3 py-2 bg-purple-600/80 hover:bg-purple-600 text-sm">🔐 Login</a>
            <a id="logoutBtn" class="hidden rounded-lg px-3 py-2 bg-white/10 hover:bg-white/20 text-sm">🚪 Keluar</a>
          </div>
        </div>

        <div class="mt-3 grid gap-2 sm:grid-cols-3">
          <div class="rounded-xl border border-white/10 bg-white/5 p-3">
            <div class="text-sm font-medium flex items-center gap-2">
              <span>✨ Akses</span>
              <span id="accessBadge" class="text-[11px] px-2 py-0.5 rounded-full border bg-purple-500/10 text-purple-300 border-purple-400/30">Belum Login</span>
            </div>
            <p class="text-[11px] text-white/70 mt-1">Login untuk mengaktifkan semua fitur.</p>
          </div>
          <div class="rounded-xl border border-white/10 bg-white/5 p-3">
            <div class="text-sm font-medium">🎓 Tutorial</div>
            <p class="text-[11px] text-white/70 mt-1">Pilih halaman → isi form → klik Generate.</p>
          </div>
          <div class="rounded-xl border border-white/10 bg-white/5 p-3">
            <div class="text-sm font-medium">⚙️ Settings</div>
            <p class="text-[11px] text-white/70 mt-1">Setelan umum disimpan lokal (localStorage).</p>
          </div>
        </div>

        <div class="mt-3 flex flex-wrap gap-2">
          <button data-page="TiktokAffiliate" class="px-3 py-2 rounded-lg bg-gradient-to-r from-purple-500 to-fuchsia-600 text-sm shadow">🔗 Tiktok Affiliate</button>
          <button data-page="FotoProduk"      class="px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-sm">📷 Foto Produk</button>
          <button data-page="GenerateImage"   class="px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-sm">🖼️ Generate Image</button>
          <button data-page="GenerateVideo"   class="px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-sm">🎬 Generate Video</button>
          <button data-page="GenerateAudio"   class="px-3 py-2 rounded-lg bg-white/10 hover:bg-white/20 text-sm">🌊 Generate Audio</button>
        </div>
      </header>

      <main class="max-w-6xl mx-auto p-4">
        <div id="root" class="min-h-[70vh] rounded-3xl border border-white/10 bg-white/5 overflow-hidden"></div>
      </main>
    </div>

    <!-- OVERLAY -->
    <div id="freeze-overlay">
      <div class="card">
        <h3 class="text-lg font-semibold mb-1">Akses dibatasi</h3>
        <p class="text-sm text-white/80">Silakan login untuk menggunakan Nafs Premium.</p>
        <button id="overlayLogin" class="mt-3 rounded-lg px-3 py-2 bg-purple-600/90 hover:bg-purple-600">🔐 Login</button>
      </div>
    </div>

    <!-- ============ K O N F I G   T U N G G A L  (no global const) ============ -->
    <script>
      (function () {
        const URLs = {
          HOME_URL : "https://nafsflow.com/",
          HERE     : new URL("/nfs/premium/", location.origin).toString(),
          LOGIN_URL: "/nfs/premium/login.html",
          LOGOUT_URL:"/nfs/premium/logout.html",
        };

        const $ = id => document.getElementById(id);
        const app     = $("app");
        const overlay = $("freeze-overlay");
        const badge   = $("accessBadge");
        const btnHome = $("homeBtn");
        const btnIn   = $("loginBtn");
        const btnOut  = $("logoutBtn");
        const btnOvIn = $("overlayLogin");

        const isLoggedIn = () => localStorage.getItem("nafs_isLoggedIn") === "1";

        function freeze() {
          app.classList.add("nfs-frozen");
          overlay.style.display = "grid";
          badge.textContent = "Belum Login";
          btnIn.classList.remove("hidden");
          btnOut.classList.add("hidden");
        }
        function unfreeze() {
          app.classList.remove("nfs-frozen");
          overlay.style.display = "none";
          badge.textContent = "Premium Aktif";
          btnIn.classList.add("hidden");
          btnOut.classList.remove("hidden");
        }
        function syncAccessUI() { isLoggedIn() ? unfreeze() : freeze(); }

        function goLogin()  { sessionStorage.setItem("prev_page", URLs.HERE); location.href = URLs.LOGIN_URL; }
        function goLogout() { sessionStorage.setItem("prev_page", URLs.HERE); location.href = URLs.LOGOUT_URL; }

        btnHome.onclick = e => { e.preventDefault(); location.href = URLs.HOME_URL; };
        btnIn.onclick   = goLogin;
        btnOvIn.onclick = goLogin;
        btnOut.onclick  = goLogout;

        window.addEventListener("storage", e => { if (e.key === "nafs_isLoggedIn") syncAccessUI(); });

        // SIMPAN SEKALI → hindari "already been declared"
        window.NAFS = Object.assign(window.NAFS || {}, {
          urls: URLs, isLoggedIn, goLogin, goLogout, syncAccessUI
        });

        // Registry halaman (harus ada sebelum file .jsx dimuat)
        window.NafsPages = window.NafsPages || {};

const URLs = {
  HOME_URL : "https://nafsflow.com/",
  HERE     : new URL("/nfs/premium/", location.origin).toString(),
  LOGIN_URL: "/nfs/premium/login.html",
  LOGOUT_URL:"/nfs/premium/logout.html",
  API_BASE : "https://nafsflow.com/api"   // <— tambahkan ini
};
        
        // Sinkron UI di awal
        syncAccessUI();
      })();
    </script>

    <!-- ===================== R O U T E R  (React) ===================== -->
    <script type="text/babel">
      const mountEl = document.getElementById("root");
      const { urls, isLoggedIn } = window.NAFS;

      // UI helpers untuk semua halaman
      function Field({ label, children, hint }) {
        return (
          <div className="space-y-1">
            <label className="text-xs text-white/60">{label}</label>
            {children}
            {hint && <p className="text-[11px] text-white/40">{hint}</p>}
          </div>
        );
      }
      function GhostInput({ as = "input", ...rest }) {
        const C = as;
        return (
          <C {...rest}
            className="w-full rounded-lg bg-white/5 border border-white/10 px-3 py-2 text-sm text-white/90 placeholder-white/30 focus:outline-none focus:ring-2 focus:ring-purple-400/30" />
        );
      }
      function ModelSelect({ value, onChange, disabled }) {
        const models = ["Gemini 2.5 Flash", "GPT-5 Thinking", "Llama 3.1", "Claude 3.5 Sonnet"];
        return (
          <div className="w-full">
            <label className="text-xs text-white/60">Model</label>
            <div className="relative mt-1">
              <select disabled={disabled} value={value} onChange={e=>onChange(e.target.value)}
                className={`w-full appearance-none rounded-xl bg-white/5 border border-white/10 px-3 py-2 pr-9 text-sm text-white/90 focus:outline-none ${disabled?"opacity-60 cursor-not-allowed":""}`}>
                {models.map(m => <option key={m} className="bg-[#1a0b2e]" value={m}>{m}</option>)}
              </select>
              <span className="absolute right-3 top-1/2 -translate-y-1/2 text-white/60">▾</span>
            </div>
          </div>
        );
      }

      function renderPage(pageName){
        const Comp = window.NafsPages[pageName];
        if(!Comp){
          ReactDOM.createRoot(mountEl).render(
            <div className="grid place-items-center min-h-[50vh] text-white/70 text-sm">
              Halaman <b className="mx-1">{pageName}</b> belum dimuat.
            </div>
          );
          return;
        }
        ReactDOM.createRoot(mountEl).render(
          <Comp
            isLoggedIn={isLoggedIn()}
            loginUrl={urls.LOGIN_URL}
            Field={Field}
            GhostInput={GhostInput}
            ModelSelect={ModelSelect}
          />
        );
      }

      document.querySelectorAll("[data-page]").forEach(btn=>{
        btn.addEventListener("click", ()=> renderPage(btn.dataset.page));
      });

      // Layar awal
      ReactDOM.createRoot(mountEl).render(
        <div className="p-6 text-sm text-white/70">Pilih salah satu halaman di bar tombol di atas untuk memulai.</div>
      );
    </script>

    <!-- =============== M U A T  H A L A M A N  (URUT & PAKAI PRESETS) =============== -->
    <script type="text/babel" data-presets="react,env" src="./generateimage.jsx?v=3"></script>
    <script type="text/babel" data-presets="react,env" src="./generatevideo.jsx?v=3"></script>
    <script type="text/babel" data-presets="react,env" src="./generateaudio.jsx?v=3"></script>
    <script type="text/babel" data-presets="react,env" src="./fotoproduk.jsx?v=3"></script>
    <script type="text/babel" data-presets="react,env" src="./tiktokaffiliate.jsx?v=3"></script>
 
  <script src="/assets/hotfix-nafsflow-20250915.js"></script>
  
  </body>
</html>
