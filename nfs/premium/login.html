<!doctype html>
<meta charset="utf-8">
<title>Login</title>
<form id="f" style="display:grid;gap:8px;max-width:320px;margin:20vh auto">
  <input id="em" type="email" placeholder="email" required>
  <input id="pw" type="password" placeholder="password" required>
  <button>Login</button>
  <div id="msg" style="color:#c33;min-height:1.2em"></div>
</form>

<script type="module">
  import { auth } from "/firebase.js?v=2";
  import { signInWithEmailAndPassword, onAuthStateChanged } 
    from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

  const form = document.getElementById('f');
  const em   = document.getElementById('em');
  const pw   = document.getElementById('pw');
  const msg  = document.getElementById('msg');
  const back = sessionStorage.getItem('prev_page') || "/nfs/premium/";

  onAuthStateChanged(auth, (u) => { if (u) location.href = back; });

  form.addEventListener('submit', async (e) => {
    e.preventDefault(); msg.textContent = '';
    try {
      await signInWithEmailAndPassword(auth, em.value.trim().toLowerCase(), pw.value);
      // diarahkan oleh onAuthStateChanged
    } catch (err) { msg.textContent = err?.message || 'Login gagal'; }
  });
</script>
